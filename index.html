<!DOCTYPE html>
<html style="height: 100%;">

    <head>
        <title>0o0E</title>
        <meta name="google-site-verification" content="TDnQ2StFQkviSIuzy4d4htuS1m455T_HTGB2lJjkgYw" />
    </head>
    <body style="text-align:center;
      background-image: -webkit-linear-gradient(top, #826021 0%, #49330a 100%);
      background-image: -moz-linear-gradient(top, #826021 0%, #49330a 100%);
      background-image: -ms-linear-gradient(top, #826021 0%, #49330a 100%);
      background-image: -o-linear-gradient(top, #826021 0%, #49330a 100%);
      background-image: linear-gradient(top, #826021 0%, #49330a 100%);"
      onload="LoadResources()">
        <h2>Enter the password:</h2>
        <div style="margin-top: 30px;">
            Only One At Once
        </div>
        <div style="margin-top: 30px;">
            All neccesary information to solve is available within the clues and this website
        </div>
        <div style="margin-top: 5px;">
            except for one clue where a star map may be useful - such clue will be obvious
        </div>
        <div style="margin-top: 30px;">
            and the puzzle is solveable on all platforms (execution of .exe file is optional)
        </div>
        <div style="margin-top: 5px;">
            provided VLC Media Player, Audacity, and GIMP (or equivalent audio/visual interpreters) are installed
        </div>
        <div style="margin-top: 30px;">
            You can attempt to solve the puzzle through <i>any means neccesary</i>. All potential exploits have been deemed sufficiently challenging.
        </div>
        <div style="margin-top: 50px;">
            <textarea rows=1 cols=20 onkeydown="checkkey( event )" onclick="removeurl()" style="resize:none; text-align: center;" id="code"></textarea>
        </div>
        <button style="margin-top: 30px;" onclick="rojf()">submit</button>
        <a id="downloadLink" style="display: none; margin-top: 30px">Download Next Clue</a>
        <div id="error" style="display: none; margin-top: 30px;">
            Not A Valid Key - Please Try Again With Another Passkey
        </div>

        <!-- You've come to the right place -->
        <!-- passkey: Nibiru -->

        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
        <script>

            function checkkey( event ) {
                if ( event.key === 'Enter' ) {
                    event.preventDefault();
                    rojf();
                }
            }

            var file0;
            var file1;
            var _file1;
            var file2;
            var _file2;
            var file3;
            var file4; 
            async function LoadResources() {
                file0 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.mp3.enc" )).text()
                file1 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.exe.enc" )).text()
                _file1 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.mp4.enc" )).text()
                file2 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.wav.enc" )).text()
                _file2 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.flac.enc" )).text()
                file3 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.ogg.enc" )).text()
                _file3 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.png.enc" )).text()
                file4 = await (await fetch( "https://solalunara.github.io/0o0E/0o0E.html.enc" )).text()
            }

            function rojf() {
                removeurl();

                String.prototype.hashCode = function() {
                    var hash = 0, i, chr;
                    if (this.length === 0) return hash;
                    for (i = 0; i < this.length; i++) {
                        chr = this.charCodeAt(i);
                        hash = ((hash << 5) - hash) + chr;
                        hash |= 0;
                    }
                    return hash;
                }

                var code = document.getElementById( 'code' ).value;
                switch ( code.hashCode() )
                {
                    case 1216985755:
                    case 1281629883:
                    case 1999612571:
                    case 729336170:
                    case 893656458:
                    case 958300586:
                    case 1042649482:
                        if ( code.length == 8 )
                            code = 'the ' + code;
                        window.location.href = CryptoJS.AES.decrypt( 'U2FsdGVkX1/kuESPwJyQ35n5zyaGZTxcIt7GhrlD9tkL/tY6jLKCamTq+eEoHg/CD9kHClcIAdVPMBeDBDdZ5EZHkkLfJsLgFR5AWxs96WE=', code.toLowerCase() ).toString( CryptoJS.enc.Utf8 );
                        break;

                    case -1961899739:
                    case -1045766907:
                    case -1992437499:
                        decryptText( file0, code.toLowerCase(), "0o0E.mp3" );
                        break;

                    case 68599:
                    case 67575:
                    case 99351:
                        decryptText( file1, code.toLowerCase(), "0o0E.exe" );
                        break;

                    case 1972518454:
                    case 1941980694:
                    case -1406316010:
                        decryptText( file2, code.toLowerCase(), "0o0E.wav" );
                        break;


                    case 1335273927:
                    case -173098585:
                    case -955725401:
                        decryptText( _file1, code.toLowerCase(), "0o0E.mp4" );
                        break;

                    case -1993889503:
                    case -2024427263:
                    case -1077756671:
                        decryptText( _file2, code.toLowerCase(), "0o0E.flac" );
                        break;

                    case -135761730:
                    case -71117602:
                    case 646865086:
                        decryptText( _file3, code.toLowerCase(), "0o0E.wav" );
                        break;

                    case -2038584168:
                    case -2008046408:
                    case -1091913576:
                        decryptText( file3, code.toLowerCase(), "0o0E.ogg" );
                        break;
                    
                    case -1395524392:
                    case 1234789624:
                    case 1952772312:
                        decryptText( file4, code.toLowerCase(), "0o0E.html" )
                        break;

                    default:
                        document.getElementById( 'error' ).style.display = 'block';
                    break;

                }
            }

            function removeurl() {
                document.getElementById( 'error' ).style.display = 'none';
                var DownloadLink = document.getElementById( 'downloadLink' );
                window.URL.revokeObjectURL( DownloadLink.href );
                DownloadLink.style.display = 'none';
            }

            function decryptFile( file, key ) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const fileContent = event.target.result;

                    const decryptedData = new Blob( [convertWordArrayToUint8Array( CryptoJS.AES.decrypt(fileContent, key) )] );

                    const downloadLink = document.getElementById('downloadLink');
                    var url = window.URL.createObjectURL(decryptedData);
                    downloadLink.href = url;
                    downloadLink.download = file.name.replace(/\.[^/.]+$/, "");
                    downloadLink.style.display = 'block';
                    window.URL.revokeObjectURL( url );
                };
                reader.readAsText(file, 'utf-8');
            }
            function decryptText( text, key, name ) {
                const fileContent = text;

                //cannot use simple string decryption
                //  CryptoJS.AES.decrypt( fileContent, key ).toString( CryptoJS.enc.Utf8 )
                //as we work with binary files often (e.g. mp3 files) and the computer has no way to validate those

                const decryptedData = new Blob( [convertWordArrayToUint8Array( CryptoJS.AES.decrypt(fileContent, key) )] );

                const downloadLink = document.getElementById('downloadLink');
                var url = window.URL.createObjectURL(decryptedData);
                downloadLink.href = url;
                downloadLink.download = name;
                downloadLink.style.display = 'block';
            }

            function convertWordArrayToUint8Array(wordArray) {
                var arrayOfWords = wordArray.hasOwnProperty("words") ? wordArray.words : [];
                var length = wordArray.hasOwnProperty("sigBytes") ? wordArray.sigBytes : arrayOfWords.length * 4;
                var uInt8Array = new Uint8Array(length), index=0, word, i;
                for (i=0; i<length; i++) {
                    word = arrayOfWords[i];
                    uInt8Array[index++] = word >> 24;
                    uInt8Array[index++] = (word >> 16) & 0xff;
                    uInt8Array[index++] = (word >> 8) & 0xff;
                    uInt8Array[index++] = word & 0xff;
                }
                return uInt8Array;
            }

        </script>
    </body>

</html>